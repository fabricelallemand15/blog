{"title":"Python match","markdown":{"yaml":{"title":"Python match","subtitle":"Une nouveauté de python 3.10","description":"Présentation de l'instruction `match ... case` en Python","date":"2023-01-30","categories":["Python","NSI","Programmation"],"image":"python_laptop.png"},"headingText":"Un cas simple","containsRefs":false,"markdown":"\n\nLa version 3.10 de python est sortie le 4 octobre 2021 et apporte parmi d'autres améliorations, une nouvelle structure conditionnelle : la structure `match ... case`.\n\n![](python310.png){fig-align=\"center\" width=\"50%\"}\n\n\nUne instruction de ce type existe déjà dans d'autres langages de programmation comme le JavaScript ou le C. Elle permet de tester une valeur et d'exécuter un bloc de code en fonction de la valeur testée. Dans ces deux langages, l'instruction s'appelle `switch ... case`. En python, elle s'appelle `match ... case`.\n\nVoici un exemple d'utilisation de l'instruction `switch ... case` en JavaScript :\n\n```{.javascript filename=\"Langage JavaScript\"}\nlet x = 3;\n\nswitch (x) {\n  case 1:\n    console.log(\"x est égal à 1\");\n    break;\n  case 2:\n    console.log(\"x est égal à 2\");\n    break;\n  case 3:\n    console.log(\"x est égal à 3\");\n    break;\n  case 4:\n    console.log(\"x est égal à 4\");\n    break;\n  default:\n    console.log(\"x n'est pas égal à 1, 2, 3 ou 4\");\n}\n```\n\nEt maintenant de C :\n\n```{.C filename=\"Langage C\"}\nint x = 3;\n\nswitch (x) {\n  case 1:\n    printf(\"x est égal à 1\");\n    break;\n  case 2:\n    printf(\"x est égal à 2\");\n    break;\n  case 3:\n    printf(\"x est égal à 3\");\n    break;\n  case 4:\n    printf(\"x est égal à 4\");\n    break;\n  default:\n    printf(\"x n'est pas égal à 1, 2, 3 ou 4\");\n}\n```\n\nC'est la même chose ! On retrouve la même structure dans les deux langages. En python, c'est la même chose :\n\n\n```{.python filename=\"Python\"}\n\nx = 3\n\nmatch x:\n    case 1:\n        print(\"x est égal à 1\")\n    case 2:\n        print(\"x est égal à 2\")\n    case 3:\n        print(\"x est égal à 3\")\n    case 4:\n        print(\"x est égal à 4\")\n    case _:\n        print(\"x n'est pas égal à 1, 2, 3 ou 4\")\n```\n\nOn peut voir que l'instruction `match ... case` est très proche de l'instruction `if ... elif ... else` en python. La différence est que l'instruction `match ... case` permet de tester plusieurs valeurs d'une variable en une seule instruction. C'est très pratique pour vérifier les valeurs d'une variable.\n\nPar rapport aux autres langages mentionnés, on remarquera qu'il n'est pas nécessaire en python d'utiliser l'instruction `break`, c'est comme d'habitude l'indentation qui délimite les blocs de code.\n\nPar ailleurs, pas d'instruction `default` en python, on utilise l'instruction `case _` pour gérer le cas par défaut.\n\n## Un cas plus complexe\n\nL'instruction `match ... case` permet de faire des choses beaucoup plus complexes, on peut par exemple ajouter des conditions à chaque cas (source : @linuxmag249) :\n\n```{.python filename=\"Python\"}\nimport random\ncible = random.randint (0, 100)\n\nnbEssai = 0\ngameOver = False\n\nwhile gameOver == False:\n   print ( f\"Vous avez essayé {nbEssai} fois\")\n   proposition = int (input (\"Votre essai : \"))\n   match proposition:\n      case ( i ) if i < 0 or i > 100:\n         print(\"Le nombre doit être compris entre 0 et 100 \")\n      case ( i ) if i < cible:\n         print(\"Trop petit !\")\n         nbEssai += 1\n      case ( i ) if i > cible:\n         print(\"Trop grand!\")\n         nbEssai += 1\n      case ( i ) if i == cible:\n         print(\"Gagné !\")\n         gameOver = True\n```\n\nDans ce jeu de devinette, la variable `proposition` est remplacées dans les conditions `case` par la variable `i`. C'est une variable temporaire qui prend la valeur de `proposition` pour chaque cas. On peut donc utiliser `i` dans les conditions `if` pour tester la valeur de `proposition`.\n\nUn dernier exemple pour terminer (source : @pythonpep636):\n\n```{.python filename=\"Python\"}\nreponse = input(\"Entrez votre prénom et votre nom : \")\n\nmatch reponse.split():\n    case [prenom, nom]:\n        print(f\"Bonjour {prenom} {nom} !\")\n    case [mot_unique]:\n        print(f\"Bonjour {mot_unique} ! Il me manque votre nom complet.\")\n    case [prenom, nom, *_]:\n        print(f\"Bonjour {prenom} {nom} ! Vous m'avez donné trop d'informations.\")\n```\n\nDans cet exemple, on utilise la méthode `split` pour découper la chaîne de caractères `reponse` en une liste de mots. On utilise ensuite cette liste dans les conditions `case` pour tester le nombre de mots dans la chaîne de caractères. Le symbole `*_` est utilisé pour représenter un nombre quelconque de mots.\n\nVoici par exemple le résultat de l'exécution de ce programme dans la console python :\n\n```{.python filename=\"Console python\"}\n>>> Entrez votre prénom et votre nom : Jean Dupont\nBonjour Jean Dupont !\n>>> Entrez votre prénom et votre nom : Jean\nBonjour Jean ! Il me manque votre nom complet.\n>>> Entrez votre prénom et votre nom : Jean Dupont et je suis un génie\nBonjour Jean Dupont ! Vous m'avez donné trop d'informations.\n```\n\n## Conclusion\n\nL'instruction `match ... case` est une instruction très puissante qui permet de simplifier le code et de le rendre plus lisible. Elle permet de tester plusieurs valeurs d'une variable en une seule instruction, mais il est aussi possible de tester des conditions plus complexes, comme le type de variable ou la longueur d'une liste, en ajoutant des conditions.\n\nPour un aperçu complet de toutes les possibilités de l'instruction `match ... case`, je vous invite à consulter la documentation officielle : [https://docs.python.org/fr/3/tutorial/controlflow.html?highlight=match#match-statements](https://docs.python.org/fr/3/tutorial/controlflow.html?highlight=match#match-statements) et les références ci-dessous."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":true,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"filters":["lightbox"],"output-file":"index.html"},"language":{},"metadata":{"lang":"fr","fig-responsive":true,"quarto-version":"1.3.146","bibliography":["../../references.bib"],"theme":{"light":["flatly","theme_light.scss"],"dark":["darkly","theme_dark.scss"]},"biblio-title":"Sources utilisées","grid":{"sidebar-width":"250px","body-width":"1000px","margin-width":"300px"},"code-block-border-left":"#31BAE9","code-block-bg":true,"comments":{"giscus":{"repo":"fabricelallemand15/blog","language":"fr"}},"lightbox":"auto","title-block-banner":"#BCD2E8","author":"F. LALLEMAND","title":"Python match","subtitle":"Une nouveauté de python 3.10","description":"Présentation de l'instruction `match ... case` en Python","date":"2023-01-30","categories":["Python","NSI","Programmation"],"image":"python_laptop.png"},"extensions":{"book":{"multiFile":true}}}}}